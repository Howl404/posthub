<app-not-found-modal
  text="There arenâ€™t any posts with that id. Double-check the post id or try searching
      for similar posts."
></app-not-found-modal>

<ng-container *ngIf="post$ | async as post">
  <div class="header">
    <div class="header-flex">
      <a [routerLink]="['/r/', communityName]">r/{{ communityName }}</a>
      <p>{{ post.date | timeAgo }}</p>
    </div>
    <a class="author-name" [routerLink]="['/u/', post.authorName]">{{ post.authorName }}</a>
  </div>

  <div class="container">
    <h2>{{ post.title }}</h2>

    <p>{{ post.description }}</p>

    <div class="footer">
      <div>
        <mat-icon> {{ post.upvotes > 1 ? 'arrow_upward' : 'arrow_downward' }}</mat-icon>
        {{ post.upvotes }}
      </div>
      <div>
        <mat-icon>comment</mat-icon>
        {{ post.commentsAmount }}
      </div>
    </div>
    <div class="add-comment">
      <ng-container *ngIf="user$ | async as user; else nonAuthorized">
        <input placeholder="Comment" [(ngModel)]="comment" name="comment" />
        <button type="button" (click)="onAddComment(user.name, post)" [disabled]="!comment.length">
          <mat-icon>add</mat-icon> Add comment
        </button>
      </ng-container>
    </div>

    <div class="comments-container">
      <ng-container *ngIf="comments$ | async as comments">
        <ng-container *ngFor="let comment of comments">
          <div class="comment">
            <div class="comment-header">
              <a [routerLink]="['/u/', comment.author]">{{ comment.author }}</a>
              <p>{{ comment.date | timeAgo }}</p>
            </div>

            <p>
              {{ comment.text }}
            </p>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </div>
</ng-container>

<ng-template #nonAuthorized>
  <input placeholder="Comment" disabled />
  <button type="button" (click)="onNonAuthorized()"><mat-icon>add</mat-icon> Add comment</button>
</ng-template>
